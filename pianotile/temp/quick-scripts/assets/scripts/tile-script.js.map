{"version":3,"sources":["tile-script.js"],"names":["cc","Class","extends","Component","properties","_type","_mainScript","init","type","mainScript","touchFunc","e","stopPropagation","console","log","_tilesArr","_curBottomRow","node","opacity","off","_start","on","onStartDown","curTile","_destory","indexOf","gameover","_errors","x","touch","getLocation","y","blockX","Math","floor","tileWidth","blockY","movePanel","children","i","length","distance","tileHeight","showWrongRedTile"],"mappings":"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","file":"tile-script.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["cc.Class({\r\n\textends: cc.Component,\r\n\r\n\tproperties: {\r\n\t\t_type: null,\r\n\t\t_mainScript: null,\r\n\t},\r\n\r\n\tinit (type, mainScript) {\r\n\t\tthis._type = type;\r\n\t\tthis._mainScript = mainScript;\r\n\t\tconst touchFunc = (e) => {\r\n\t\t\te.stopPropagation()\r\n\t\t\tconsole.log('in touchFunc')\r\n\t\t\tif(this._mainScript._tilesArr[this._mainScript._curBottomRow] === this.node) {\r\n\t\t\t\tthis.node.opacity = 80\r\n\t\t\t\tthis.node.off(\"touchstart\", touchFunc, false);\r\n\t\t\t\tswitch (this._type) {\r\n\t\t\t\t\tcase 'START':\r\n\t\t\t\t\t\t//播放音乐\r\n\t\t\t\t\t\tthis._mainScript._start = true;\r\n\t\t\t\t\t\tconsole.log('startstartstartstart')\r\n\t\t\t\t\t\tthis._mainScript.node.on(\"touchstart\", this.onStartDown, this)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'BLACK':\r\n\t\t\t\t\t\t//播放音乐\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'LONG':\r\n\t\t\t\t\t\t//播放音乐\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tconst curTile = this._mainScript._tilesArr[this._mainScript._curBottomRow]\r\n\t\t\t\tcurTile._destory = !curTile._destory\r\n\t\t\t\tthis._mainScript._curBottomRow++\r\n\t\t\t} else {\r\n\t\t\t\tif(!this._mainScript._start) return\r\n\t\t\t\tif(!!~['BLACK', 'LONG'].indexOf(this.node.type)) {\r\n\t\t\t\t\tconsole.log('nothing')\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._mainScript.gameover(this._mainScript._errors[0]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.node.on(\"touchstart\", touchFunc, this);\r\n\t},\r\n\r\n\tonStartDown (e) {\r\n\t\tthis._mainScript.node.off(\"touchstart\", this.onStartDown, this)\r\n\t\te.stopPropagation()\r\n\t\tlet x = e.touch.getLocation().x;\r\n\t\tlet y = e.touch.getLocation().y;\r\n\t\tconsole.log('onStartDown x', x)\r\n\t\tconsole.log('onStartDown y', y)\r\n\t\tlet blockX = Math.floor(x / this._mainScript.tileWidth);\r\n\t\tlet blockY = 0;\r\n\t\tconsole.log('onStartDown this._mainScript.movePanel.children', this._mainScript.movePanel.children)\r\n\t\tfor (let i = this._mainScript.movePanel.children.length - 1; i >= 0; i--) {\r\n\t\t\tlet distance = this._mainScript.movePanel.children[i].y - y;\r\n\t\t\tif (distance <= this._mainScript.tileHeight && distance >= 0) {\r\n\t\t\t\tblockY = i;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._mainScript.showWrongRedTile(blockX, blockY)\r\n\t},\r\n\r\n\t// update (dt) {\r\n\t//\r\n\t// },\r\n\r\n});\r\n"]}